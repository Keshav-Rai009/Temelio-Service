openapi: 3.0.2
info:
  title: Temelio Service
  description: "This service exposes Temelio endpoints (internal use only)"
  version: "0.0.1"
servers:
  - url: /v1
tags:
  - name: Non Profit
    description: APIs related to Non Profits.
  - name: Grand Submission
    description: APIs related to Grand Submissions.
paths:
  /nonprofits:
    get:
      summary: Gets Non Profits
      tags:
        - Non Profit
      responses:
        200:
          description: Gets distinct types of non profits
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/NonProfit"

    post:
      summary: Adds a new Non Profit
      tags:
        - Non Profit
      responses:
        202:
          description: Adds a new non profit with autogenerated id
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/NonProfit"
        400:
          description: Bad request body for non profit

  /nonprofits/{nonProfitId}:
        get:
          summary: Gets a non profit by id
          tags:
            - Non Profit
          parameters:
            - $ref: "#/components/parameters/nonProfitId"
          responses:
            200:
              description: Gets requested non profits
              content:
                application/json:
                  schema:
                    $ref: "#/components/schemas/NonProfit"
            404:
              description: Invalid non profit id

        put:
          summary: Updates the existing non profit content with new payload
          tags:
            - Non Profit
          parameters:
            - $ref: "#/components/parameters/nonProfitId"
          requestBody:
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/NonProfit"
          responses:
            200:
              description: Non profit updated
            404:
              description: Invalid non profit id

  /nonprofits/{nonProfitId}/submissions:
    get:
      summary: Gets Non Profit's grand submissions
      tags:
        - Grand Submission
      parameters:
        - $ref: "#/components/parameters/nonProfitId"
      responses:
        200:
          description: Gets distinct types of grand submissions
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/GrandSubmission"
        404:
          description: Invalid non profit id

    post:
      summary: Adds a new grand submission for a Non Profit
      tags:
        - Grand Submission
      parameters:
        - $ref: "#/components/parameters/nonProfitId"
      responses:
        202:
          description: Adds a new grand submssion for a given non profit with autogenerated id
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GrandSubmission"
        400:
          description: Bad request body for grand submision

        404:
          description: Invalid non profit id

  /nonprofits/{nonProfitId}/submissions/{grandSubmissionId}:
        get:
          summary: Gets a grand submission for a givem non profit id
          tags:
            - Grand Submission
          parameters:
            - $ref: "#/components/parameters/nonProfitId"
            - $ref: "#/components/parameters/grandSubmissionId"
          responses:
            200:
              description: Gets requested grand submssion
              content:
                application/json:
                  schema:
                    $ref: "#/components/schemas/GrandSubmission"
            404:
              description: Invalid non profit id or grand submission id

        put:
          summary: Updates the existing non profit content with new payload for a givem non profit id
          tags:
            - Grand Submission
          parameters:
            - $ref: "#/components/parameters/nonProfitId"
            - $ref: "#/components/parameters/grandSubmissionId"
          requestBody:
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/GrandSubmission"
          responses:
            200:
              description: Non profit updated
            400:
              description: Bad request body for grand submision
            404:
              description: Invalid non profit or grand submission id

  /nonprofits/submissions:
    get:
      summary: Gets Non Profit's grand submissions for all non profits
      tags:
        - Grand Submission
      responses:
        200:
          description: Gets distinct types of grand submissions
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/GrandSubmission"

security:
  - bearerAuth: [] # scopes not defined

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  parameters:
    nonProfitId:
      name: nonProfitId
      in: path
      required: true
      description: Non Profit unique identifier.
      example: db393a4d-1364-4e6f-944f-309c92f4dd61
      schema:
        type: string
    grandSubmissionId:
      name: grandSubmissionId
      in: path
      required: true
      description: Grand Submission unique identifier.
      example: cd393a4d-1364-4e6f-944f-309c92f1eea
      schema:
        type: string
  schemas:
    NonProfit:
      title: Non Profit
      type: object
      required:
        - id
        - legalName
        - EIN
      properties:
        id:
          type: string
          description: Non Profit unique identifier.
          example: db393a4d-1364-4e6f-944f-309c92f4dd61
        legalName:
          type: string
          description: Non Profit Name
          example: Girls in Tech
          pattern: ^[a-zA-Z0-9][A-Za-z0-9 _@./#&+-]*$
        EIN:
          type: string
          description: Non Profit tax id.
          example: '43512550'
        mission:
          type: string
          description: Non Profit mission.
          example: CATF is a nonprofit organization dedicated to reducing atmospheric pollution through research, advocacy, and private sector collaboration.
        address:
          $ref: "#/components/schemas/Address"
        grandSubmissions:
          type: array
          items:
            $ref: "#/components/schemas/GrandSubmission"
          description: Non profit grand submissions
          nullable: true

    GrandSubmission:
      title: Non Profit Grand Submission
      type: object
      required:
        - id
        - nonProfitName
        - nonProfitId
        - grandName
      properties:
        id:
          type: string
          description: Grand submission unique identifier (autogenerated)
        nonProfitId:
          type: string
          description: Non profit guid
        nonProfitName:
          type: string
          description: Non profit legal name
          pattern: ^[a-zA-Z0-9][A-Za-z0-9 _@./#&+-]*$
        grandName:
          type: string
          description: Grand submission name
          pattern: ^[a-zA-Z0-9][A-Za-z0-9 _@./#&+-]*$
        requestedAmount:
          type: string
          description: Requested grand amount
        awardedAmount:
          type: string
          description: Awarded grand amount
        grandType:
          type: string
          enum:
            - OPERATING_GRANT
            - PROJECT_GRANT
            - OTHER
        tags:
          type: array
          items:
            type: string
          description: Grand tags
          example: [Global Health, Climate]
        duration:
          $ref: "#/components/schemas/Duration"


    Address:
      title: Address
      type: object
      properties:
        street:
          type: string
          example: Street 11
        city:
          type: string
          example: NY
        state:
          type: string
          description: State name
          example: Washington
        zip:
          type: string
          description: Postal Code
          example: 11002


    Duration:
      title: Grand Duration
      type: object
      properties:
        grandStart:
          type: string
          example: "12/01/2023"
        grandEnd:
          type: string
          example: "12/01/2024"
